CREATE DATABASE Storage
USE Storage

CREATE TABLE ProductTypes (
    ProductTypeID INT IDENTITY PRIMARY KEY,
    Type VARCHAR(255)
);

CREATE TABLE Suppliers (
    SupplierID INT IDENTITY PRIMARY KEY,
    Name VARCHAR(255),
    Address VARCHAR(255) NULL, 
    Phone VARCHAR(20) NULL 
);
CREATE TABLE Products (
    ProductID INT IDENTITY PRIMARY KEY,
    Name VARCHAR(255),
    ProductTypeID INT,
    SupplierID INT,
    Cost DECIMAL(10, 2),
    FOREIGN KEY (ProductTypeID) REFERENCES ProductTypes(ProductTypeID),
    FOREIGN KEY (SupplierID) REFERENCES Suppliers(SupplierID)
);

CREATE TABLE Deliveries (
    DeliveryID INT IDENTITY PRIMARY KEY,
    ProductID INT,
    Date DATE,
    Quantity INT,
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID)
);


INSERT INTO ProductTypes (Type)
VALUES 
    ('Электроника'),
    ('Одежда'),
    ('Мебель'),
    ('Игрушки'),
    ('Книги'),
    ('Товары для дома'),
    ('Продукты питания и напитки'),
    ('Фармацевтика'),
    ('Канцелярские товары'),
    ('Косметика'),
    ('Спортивные товары'),
    ('Автозапчасти'),
    ('Товары для сада'),
    ('Товары для животных'),
    ('Строительные материалы');


-- Поставщики

INSERT INTO Suppliers (Name, Address, Phone) VALUES
('ООО "ЭлектроМир"', 'ул. Хрещатик, 24, Киев, 01001', '+380 (44) 123-45-67'),
('ЧП "Книжный Рай"', 'просп. Свободы, 48, Львов, 79000', '+380 (32) 765-43-21'),
('ООО "ДомТехника"', 'ул. Пушкинская, 12, Одесса, 65000', '+380 (48) 123-98-76'),
('ЧП "СпортТовары"', 'пр. Гагарина, 33, Харьков, 61000', '+380 (57) 987-65-43'),
('ООО "СтройМатериалы"', 'ул. Соборная, 5, Днепр, 49000', '+380 (56) 234-56-78'),
('ООО "АгроСнаб"', 'пер. Шевченко, 3, Запорожье, 69000', '+380 (61) 707-83-45'),
('ЧП "МебельШик"', 'бул. Шевченко, 8, Луганск, 91000', '+380 (64) 123-45-67'),
('ООО "ГарденСервис"', 'ул. Центральная, 21, Симферополь, 95000', '+380 (65) 987-65-43'),
('ООО "Канцелярский Мир"', 'просп. Мира, 19, Чернигов, 14000', '+380 (46) 765-43-21'),
('ЧП "ЭлитКосметика"', 'ул. Главная, 28, Полтава, 36000', '+380 (53) 234-56-78'),
('ООО "Вкусные Продукты"', 'ул. Богдана Хмельницкого, 45, Ивано-Франковск, 76000', '+380 (342) 987-65-43'),
('ЧП "ТехноСвет"', 'пр. Победы, 37, Тернополь, 46000', '+380 (352) 123-45-67'),
('ООО "Промышленные Решения"', 'ул. Короленко, 12, Хмельницкий, 29000', '+380 (382) 765-43-21'),
('ООО "АвтоЧасти"', 'пр. Металлургов, 9, Запорожье, 69000', '+380 (61) 234-56-78'),
('ЧП "Детский Мир"', 'ул. Степана Бандеры, 54, Львов, 79000', '+380 (32) 987-65-43'),
('ООО "Красота и Здоровье"', 'пр. Мира, 22, Черкассы, 18000', '+380 (472) 354-12-65'),
('ООО "Уютный Дом"', 'ул. Гагарина, 3, Житомир, 10000', '+380 (412) 987-65-43'),
('ЧП "СтройЭлемент"', 'пр. Центральный, 15, Винница, 21000', '+380 (432) 123-45-67'),
('ООО "Эко Продукты"', 'ул. Леси Украинки, 78, Ровно, 33000', '+380 (362) 765-43-21'),
('ЧП "ГлобалТрейд"', 'бул. Шевченко, 100, Ужгород, 88000', '+380 (312) 234-56-78');

INSERT INTO Suppliers (Name, Address, Phone) VALUES
('ООО "Мода и Стиль"', 'ул. Хрещатик, 24, Киев, 01001', '+380 (44) 987-65-43');


SELECT * FROM Suppliers


INSERT INTO Products (Name, ProductTypeID, SupplierID, Cost) VALUES
('Смартфон Galaxy S21', 1, 1, 69999.99),
('Ноутбук MacBook Pro', 1, 1, 129999.50),
('Электронная книга Kindle', 1, 2, 15999.00),
('Футболка мужская', 2, 21, 1199.99),
('Кроссовки беговые', 2, 4, 4999.95),
('Кофеварка Delonghi', 1, 12, 7999.99),
('Стиральная машина LG', 1, 12, 25999.90),
('Шкаф книжный', 3, 7, 11999.00),
('Игрушка мягкая "Мишка"', 4, 15, 899.99),
('Планшет iPad Air', 1, 1, 56999.99),
('Парфюм Chanel No5', 10, 10, 10999.99),
('Спортивный инвентарь: скакалка', 11, 4, 299.99),
('Автомобильные шины', 12, 14, 7999.00),
('Удобрения для растений', 8, 6, 499.99),
('Корм для собак', 14, 15, 2499.99),
('Строительная краска', 15, 5, 1599.99),
('Помада Loreal', 10, 10, 799.99),
('Ручка шариковая', 9, 9, 49.99),
('Тетрадь в клетку', 9, 9, 14.99),
('Соковыжималка Philips', 1, 12, 2999.99),
('Беспроводные наушники', 1, 5, 12999.99),
('Велосипед горный', 11, 4, 23999.50),
('Умные часы', 1, 1, 18999.00),
('Джинсы женские', 2, 2, 2799.99),
('Спортивный костюм', 2, 4, 5999.95),
('Микроволновая печь Samsung', 1, 3, 9999.99),
('Холодильник Bosch', 1, 12, 45999.90),
('Книжная полка', 3, 7, 4999.00),
('Детский велосипед', 4, 4, 7999.99),
('Монитор Dell', 1, 1, 14999.99),
('Паровая станция Tefal', 1, 3, 8999.99),
('Шорты мужские', 2, 21, 1199.00),
('Зимняя шина Michelin', 12, 14, 10999.00),
('Семена помидоров', 13, 8, 99.99),
('Корм для кошек', 14, 15, 1999.99),
('Лак для ногтей', 10, 16, 299.99),
('Зубная паста Colgate', 10, 17, 199.99),
('Блокнот А5', 9, 9, 59.99),
('Мыло Dove', 10, 19, 99.99),
('Чайник электрический', 1, 12, 2499.99),
('Плойка для волос', 1, 1, 2999.00),
('Мужской ремень', 2, 21, 899.99),
('Солнцезащитные очки', 2, 21, 1499.99),
('Электрогриль', 1, 12, 6599.99),
('Настольная лампа', 1, 12, 2399.99),
('Клавиатура беспроводная', 1, 1, 1999.99),
('Средство для мытья посуды', 10, 11, 299.99),
('Кроссовки для бега', 11, 4, 7499.99),
('Масло моторное', 12, 13, 4500.00),
('Шампунь Head & Shoulders', 10, 15, 399.99),
('Маска для лица', 10, 10, 250.99),
('Карандаши цветные', 9, 9, 499.99),
('Журнал мод', 9, 10, 299.99),
('Гель для душа Nivea', 10, 19, 349.99),
('Фильтр для воды', 1, 5, 1899.99),
('Гантели 5 кг', 11, 4, 2599.00),
('Подгузники', 14, 15, 1199.00),
('Антисептик для рук', 10, 20, 299.00),
('Игровая консоль PlayStation 5', 1, 1, 46999.99),
('Оливковое масло Extra Virgin', 7, 11, 599.99),
('Органический кофе в зернах', 7, 11, 1099.50),
('Цельнозерновой хлеб', 7, 19, 199.99),
('Натуральный йогурт', 7, 19, 299.99),
('Био кефир', 7, 19, 249.99),
('Детский пазл "Космос"', 4, 15, 499.99),
('Игрушечная кухня', 4, 15, 2999.99);

SELECT *  FROM Products


INSERT INTO Deliveries (ProductID, Date, Quantity) VALUES
(1, '2023-01-10', 100),
(2, '2023-01-15', 150),
(3, '2023-02-01', 200),
(4, '2023-02-05', 250),
(5, '2023-02-10', 300),
(6, '2023-03-01', 350),
(7, '2023-03-15', 400),
(8, '2023-04-01', 450),
(9, '2023-04-15', 500),
(10, '2023-05-01', 550);

INSERT INTO Deliveries (ProductID, Date, Quantity) VALUES
(11, '2023-05-15', 600),
(12, '2023-06-01', 650),
(13, '2023-06-15', 700),
(14, '2023-07-01', 750),
(15, '2023-07-15', 800),
(16, '2023-08-01', 850),
(17, '2023-08-15', 900),
(18, '2023-09-01', 950),
(19, '2023-09-15', 1000),
(20, '2023-10-01', 1050),
(21, '2023-01-10', 100),
(22, '2023-01-15', 150),
(23, '2023-02-01', 200),
(24, '2023-02-05', 250),
(25, '2023-02-10', 300),
(26, '2023-03-01', 350),
(27, '2023-03-15', 400),
(28, '2023-04-01', 450),
(29, '2023-04-15', 500),
(30, '2023-05-01', 550);

INSERT INTO Deliveries (ProductID, Date, Quantity) VALUES
(31, '2023-05-15', 600),
(32, '2023-06-01', 650),
(33, '2023-06-15', 700),
(34, '2023-07-01', 750),
(35, '2023-07-15', 800),
(36, '2023-08-01', 850),
(37, '2023-08-15', 900),
(38, '2023-09-01', 950),
(39, '2023-09-15', 1000),
(40, '2023-10-01', 1050),
(41, '2023-01-10', 100),
(42, '2023-01-15', 150),
(43, '2023-02-01', 200),
(44, '2023-02-05', 250),
(45, '2023-02-10', 300),
(46, '2023-03-01', 350),
(47, '2023-03-15', 400),
(48, '2023-04-01', 450),
(49, '2023-04-15', 500),
(40, '2023-05-01', 550),
(41, '2023-05-15', 600),
(42, '2023-06-01', 650),
(43, '2023-06-15', 700),
(44, '2023-07-01', 750),
(45, '2023-07-15', 800),
(46, '2023-08-01', 850),
(47, '2023-08-15', 900),
(48, '2023-09-01', 950),
(49, '2023-09-15', 1000),
(50, '2023-10-01', 1050);

INSERT INTO Deliveries (ProductID, Date, Quantity) VALUES
(51, '2023-05-15', 600),
(52, '2023-06-01', 650),
(53, '2023-06-15', 700),
(54, '2023-07-01', 750),
(55, '2023-07-15', 800),
(56, '2023-08-01', 850),
(57, '2023-08-15', 900),
(58, '2023-09-01', 950),
(59, '2023-09-15', 1000),
(60, '2023-10-01', 1050),
(61, '2023-01-10', 100),
(62, '2023-01-15', 150),
(63, '2023-02-01', 200),
(64, '2023-02-05', 250),
(65, '2023-02-10', 300),
(66, '2023-03-01', 350);


INSERT INTO Deliveries (ProductID, Date, Quantity) VALUES
(8, '2023-04-01', 450),
(9, '2023-04-15', 500),
(1, '2023-05-15', 600),
(2, '2023-06-01', 650),
(3, '2023-06-15', 700),
(4, '2023-07-01', 750),
(5, '2023-07-15', 800),
(46, '2023-08-01', 850),
(47, '2023-08-15', 900),
(48, '2023-09-01', 950),
(9, '2023-09-15', 1000),
(5, '2023-10-01', 1050);












SELECT 
    p.ProductID AS 'Идентификатор продукта', 
    p.Name AS 'Название продукта', 
    pt.Type AS 'Тип продукта', 
    s.Name AS 'Название поставщика', 
    p.Cost AS 'Стоимость'
FROM Products p
INNER JOIN ProductTypes pt ON p.ProductTypeID = pt.ProductTypeID
INNER JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.Name = 'ЧП "МебельШик"';

SELECT 
    pt.Type AS 'Тип продукта', 
    AVG(CAST(d.Quantity AS FLOAT)) AS 'Среднее количество'
FROM Deliveries d
JOIN Products p ON d.ProductID = p.ProductID
JOIN ProductTypes pt ON p.ProductTypeID = pt.ProductTypeID
GROUP BY pt.Type;